names(nbaPred)
glmModel  <- train(FPPM ~ . ,
data = training, method="glm", preProcess="scale")
summary(glmModel)
predictGlm  <- predict(glmModel, newdata = testing)
mean(sqrt((testing$FPPM - predictGlm)^2), na.rm = TRUE)
mpartModel  <- rpart(FPPM ~ . , data = training)
mpartPred  <- predict(mpartModel, newdata = testing)
summary(mpartModel)
rpart.plot(mpartModel, type =3, fallen.leaves = TRUE)
mpartPred - training$FPPM
str(mpartPred)
length(mpartPred)
length(training$FPPM) -
0
testing$FPPM - mpartPred
sqrt(mean(testing$FPPM - mpartPred)^2))
mean(sqrt(testing$FPPM - mpartPred)^2)
mean(sqrt((testing$FPPM - mpartPred)^2))
mean(sqrt((testing$FPPM - m5pPred)^2))
m5pModel  <- M5P(FPPM ~ . , data = training)
m5pPred  <- predict(m5pModel, newdata = testing)
mean(sqrt((testing$FPPM - m5pPred)^2))
m5pModel
mean(sqrt((testing$FPPM - boostModel)^2))
boostModel <- train(FPPM ~ ., data = training, method="gbm")
boostPred  <- predict(boostModel, newdata = testing)
mean(sqrt((testing$FPPM - boostModel)^2))
mean(sqrt((testing$FPPM - boostPred)^2))
mean(sqrt((testing$FPPM - m5pPred)^2))
mean(sqrt((testing$FPPM - mpartPred)^2))
if(require("party", quietly = TRUE)) plot(m1)
plot(m5pModel)
nba[ order(-nba[,27]), c(1,2,4,21,22,23,26,27)]
m5pModel
nba[ order(-nba[,25]), c(1,2,4,21,22,23,26,27)]
names(nba)
nba[ order(-nba[,23]), c(1,2,4,21,22,23,26,27)]
teste  <- nba$FPPG / nba$MPG
teste - nba$FPPM
round(teste - nba$FPPM, 2)
load("~/nba-predictions/.RData")
library(caret)
library(rpart)
library(rpart.plot)
library(RWeka)
m5pModel  <- M5P(custom ~ . , data = training)
## Set working directory
setwd("~/nba-predictions/")
## Open csv
nba  <- read.csv("nba_stats.csv")
## Open Team %
teamPer  <- read.csv("teamStats.csv")
## Team Classification
nba$team  <- gsub(".*\\(|\\)","", nba$STATS)
## Merge Data
nba  <- merge(nba, teamPer, by="team", all.x = TRUE)
## Clean names
nba$STATS  <- gsub("\\\n.*","", nba$STATS)
## Custom Classification
nba$custom  <- (nba$APG * 1.1 + nba$ORPG * 1.2 + nba$DRPG + nba$PPG - nba$TPG + nba$winning)/nba$MPG
nba$custom  <- ifelse(is.na(nba$custom), nba$FPPM,  nba$custom)
set.seed(999)
nbaPred <- nba[,-c(1,2,3,4,6,7,8,10,20,21,22,23,24,25)]
inTraining  <- createDataPartition(nbaPred$custom, p = .75, list = FALSE)
training  <- nbaPred[inTraining, ]; testing  <- nbaPred[-inTraining,]
m5pModel  <- M5P(custom ~ . , data = training)
m5pPred  <- predict(m5pModel, newdata = testing)
summary(m5pModel)
m5pModel
mean(sqrt((testing$custom - m5pPred)^2))
boostModel <- train(custom ~ ., data = training, method="gbm")
boostPred  <- predict(boostModel, newdata = testing)
mean(sqrt((testing$custom - boostPred)^2))
boostModel
?gbm
summary(predictGlm)
summary(mpartPred)
summary(m5pPred)
summary(boostPred)
summary(testing$FPPM)
summary(testing$custom)
table(nba$team)
nbaPred  <- subset(nba, nba$team!="*FA")
nba  <- read.csv("nba_stats.csv")
## Open Team %
teamPer  <- read.csv("teamStats.csv")
## Team Classification
nba$team  <- gsub(".*\\(|\\)","", nba$STATS)
nba  <- merge(nba, teamPer, by="team", all.x = TRUE)
nba$STATS  <- gsub("\\\n.*","", nba$STATS)
nba$custom  <- (nba$APG * 1.1 + nba$ORPG * 1.2 + nba$DRPG + nba$PPG - nba$TPG + nba$winning)/nba$MPG
set.seed(999)
nbaPred  <- subset(nba, nba$team!="*FA")
nbaPred <- nbaPred[,-c(1,2,3,4,6,7,8,10,20,21,22,23,24,25)]
inTraining  <- createDataPartition(nbaPred$custom, p = .75, list = FALSE)
training  <- nbaPred[inTraining, ]; testing  <- nbaPred[-inTraining,]
glmModel  <- train(custom ~ . ,
data = training, method="glm", preProcess="scale")
summary(glmModel)
predictGlm  <- predict(glmModel, newdata = testing)
mean(sqrt((testing$custom - predictGlm)^2), na.rm = TRUE)
summary(testing$custom)
mpartModel  <- rpart(custom ~ . , data = training)
mpartPred  <- predict(mpartModel, newdata = testing)
mean(sqrt((testing$custom - mpartPred)^2))
summary(mpartModel)
m5pModel  <- M5P(custom ~ . , data = training)
m5pPred  <- predict(m5pModel, newdata = testing)
summary(m5pModel)
m5pModel
boostModel <- train(custom ~ ., data = training, method="gbm")
boostPred  <- predict(boostModel, newdata = testing)
boostModel
mean(sqrt((testing$custom - boostPred)^2))
mean(sqrt((testing$custom - m5pPred)^2))
summary(predictGlm)
summary(mpartPred)
summary(m5pPred)
summary(boostPred)
summary(testing$custom)
boxplot(testing$custom, boostPred, m5pPred, mpartPred,predictGlm)
cor(testing$custom, boostPred, m5pPred, mpartPred,predictGlm)
cor.test(testing$custom, boostPred, m5pPred, mpartPred,predictGlm)
cor(testing$custom, boostPred)
cor(testing$custom, m5pPred)
cor(testing$custom, mpartPred)
cor(testing$custom, predictGlm)
nba[ order(-nba[,27]), c(1,2,4,21,22,23,26,27)]
library(caret)
library(rpart)
library(rpart.plot)
library(RWeka)
setwd("~/nba-predictions/")
nba  <- read.csv("nba_stats2.csv")
head(nba)
rm(nba)
## Set working directory
setwd("~/nba-predictions/")
## Open csv
nba  <- read.csv("nba_stats.csv")
## Open Team %
teamPer  <- read.csv("teamStats.csv")
## Team Classification
nba$team  <- gsub(".*\\(|\\)","", nba$STATS)
## Merge Data
nba  <- merge(nba, teamPer, by="team", all.x = TRUE)
## Clean names
nba$STATS  <- gsub("\\\n.*","", nba$STATS)
## Custom Classification
nba$custom  <- (nba$APG * 1.1 + nba$ORPG * 1.2 + nba$DRPG + nba$PPG - nba$TPG + nba$winning)/nba$MPG
cor(nba[, c("PPG", "APG", "BPG", "SPG", "DRPG", "ORPG","TPG","custom")])
set.seed(999)
nbaPred  <- subset(nba, nba$team!="*FA")
nbaPred <- nbaPred[,-c(1,2,3,4,6,7,8,10,20,21,22,23,24,25)]
inTraining  <- createDataPartition(nbaPred$custom, p = .75, list = FALSE)
training  <- nbaPred[inTraining, ]; testing  <- nbaPred[-inTraining,]
glmModel  <- train(custom ~ . ,
data = training, method="glm", preProcess="scale")
summary(glmModel)
## Predict
predictGlm  <- predict(glmModel, newdata = testing)
mean(sqrt((testing$custom - predictGlm)^2), na.rm = TRUE)
summary(testing$custom)
## Classification and Regression Trees
# CART algorithm
mpartModel  <- rpart(custom ~ . , data = training)
mpartPred  <- predict(mpartModel, newdata = testing)
mean(sqrt((testing$custom - mpartPred)^2))
summary(mpartModel)
#rpart.plot(mpartModel, type =3, fallen.leaves = TRUE)
## M5P - Weka
m5pModel  <- M5P(custom ~ . , data = training)
m5pPred  <- predict(m5pModel, newdata = testing)
summary(m5pModel)
m5pModel
mean(sqrt((testing$custom - m5pPred)^2))
## GBM - Boost
boostModel <- train(custom ~ ., data = training, method="gbm")
boostPred  <- predict(boostModel, newdata = testing)
boostModel
mean(sqrt((testing$custom - boostPred)^2))
summary(predictGlm)
boxplot(testing$custom, boostPred, m5pPred, mpartPred,predictGlm)
nba[ order(-nba[,27]), c(1,2,4,21,22,23,26,27)]
cor(testing$custom, testing$FPPM)
cor(nba$custom, nba$FPPM)
cor(nba$custom, nba$FPPM, na.rm=TRUE)
cor(nba$custom, nba$FPPM, "complete.obs")
nba[ order(-nba[,27]), c(1,2,4,21,22,23,26,27)]
nba[ order(-nba[,27]), c(1,2,4,22,23,26,27)]
nba[ order(-nba[,27]), c(1,2,4,23,27)]
nba2k4 <- read.csv("nba_stats13-14.csv")
head(nba2k4)
nba2k3 <- read.csv("nba_stats_12-13.csv")
nba2k2 <- read.csv("nba_stats_11-12.csv")
nba2k4$team  <- gsub(".*\\(|\\)","", nba2k4$STATS)
nba2k4$STATS  <- gsub("\\\n.*","", nba$nba2k4)
nba2k4 <- read.csv("nba_stats13-14.csv")
nba2k3 <- read.csv("nba_stats_12-13.csv")
nba2k2 <- read.csv("nba_stats_11-12.csv")
nba2k4$team  <- gsub(".*\\(|\\)","", nba2k4$STATS)
nba2k4$STATS  <- gsub("\\\n.*","", nba2k4$STATS)
nba2k4$custom  <- (nba2k4$APG * 1.1 + nba2k4$ORPG * 1.2 + nba2k4$DRPG + nba2k4$PPG - nba2k4$TPG)/nba2k4$MPG
nba2k3$team  <- gsub(".*\\(|\\)","", nba2k3$STATS)
nba2k3$STATS  <- gsub("\\\n.*","", nba$STATS)
nba2k4 <- read.csv("nba_stats13-14.csv")
nba2k2$team  <- gsub(".*\\(|\\)","", nba2k2$STATS)
nba2k2$STATS  <- gsub("\\\n.*","", nba2k2$STATS)
nba2k2$custom  <- (nba2k2$APG * 1.1 + nba2k2$ORPG * 1.2 + nba2k2$DRPG + nba2k2$PPG - nba2k2$TPG)/nba2k2$MPG
nba2k2$STATS[1:10]
nba2k2$team
names(nba2k2)
names(nba2k3)
names(nba2k2)
nba2k3$custom  <- (nba2k3$APG * 1.1 + nba2k3$ORPG * 1.2 + nba2k3$DRPG + nba2k3$PPG - nba2k3$TPG)/nba2k3$MPG
nba2k2$custom  <- (nba2k2$APG * 1.1 + nba2k2$ORPG * 1.2 + nba2k2$DRPG + nba2k2$PPG - nba2k2$TPG)/nba2k2$MPG
names(nba2k2)
names(nba2k3)
table(nba2k3$FAN)
table(nba2k4$FAN)
nba2k4 <- nba2k14[,-c("Age","G","RPG","ADP","O")]
nba2k4 <- nba2k4[,-c("Age","G","RPG","ADP","O")]
nba2k4[,-c("Age","G","RPG","ADP","O")]
nbaAll  <- merge(nba2k2, nba2k3, by=STATS)
names(nba2k2)
nbaAll  <- merge(nba2k2, nba2k3, by="STATS")
nbaAll  <- merge(nba2k2, nba2k3, by=STATS)
names(nba2k3)
?merge
head(nba2k2$STATS)
nbaAll  <- merge(nba2k2, nba2k3, by.x="STATS", by.y="STATS")
nbaAll  <- merge(nba2k2, nba2k3, by.x=STATS, by.y=STATS)
nbaAll  <- merge(nba2k2, nba2k3, by.x=nba2k2$STATS, by.y=nba2k3$STATS)
nbaAll  <- merge(nba2k2, nba2k3, by="STATS", all = TRUE)
head(nbaAll$STATS)
nba2k4 <- read.csv("nba_stats13-14.csv")
nba2k3 <- read.csv("nba_stats_12-13.csv")
nba2k2 <- read.csv("nba_stats_11-12.csv")
nba2k4$team  <- gsub(".*\\(|\\)","", nba2k4$STATS)
nba2k4$STATS  <- gsub("\\\n.*","", nba2k4$STATS)
nba2k4$custom  <- (nba2k4$APG * 1.1 + nba2k4$ORPG * 1.2 + nba2k4$DRPG + nba2k4$PPG - nba2k4$TPG)/nba2k4$MPG
nba2k3$team  <- gsub(".*\\(|\\)","", nba2k3$STATS)
nba2k3$STATS  <- gsub("\\\n.*","", nba2k3$STATS)
nba2k3$custom  <- (nba2k3$APG * 1.1 + nba2k3$ORPG * 1.2 + nba2k3$DRPG + nba2k3$PPG - nba2k3$TPG)/nba2k3$MPG
nba2k2$team  <- gsub(".*\\(|\\)","", nba2k2$STATS)
nba2k2$STATS  <- gsub("\\\n.*","", nba2k2$STATS)
nba2k2$custom  <- (nba2k2$APG * 1.1 + nba2k2$ORPG * 1.2 + nba2k2$DRPG + nba2k2$PPG - nba2k2$TPG)/nba2k2$MPG
nba2k2$STATS
nba2k3$STATS
nba2k2$STATS  <- gsub("\\\n.*|\\*","", nba2k2$STATS)
nba2k2$STATS
library("tm")
nba2k2$STATS  <-  stripWhitespace(nba2k2$STATS)
nba2k2$STATS
nba2k2 <- read.csv("nba_stats_11-12.csv")
nba2k2$team  <- gsub(".*\\(|\\)","", nba2k2$STATS)
nba2k2$STATS  <- gsub("\\\n.*","", nba2k2$STATS)
nba2k2$STATS  <-  removePunctuation(nba2k2$STATS)
nba2k2$STATS
nba2k4 <- read.csv("nba_stats13-14.csv")
nba2k3 <- read.csv("nba_stats_12-13.csv")
nba2k2 <- read.csv("nba_stats_11-12.csv")
nba2k4$team  <- gsub(".*\\(|\\)","", nba2k4$STATS)
nba2k4$STATS  <- gsub("\\\n.*","", nba2k4$STATS)
nba2k4$STATS  <-  removePunctuation(nba2k4$STATS)
nba2k4$custom  <- (nba2k4$APG * 1.1 + nba2k4$ORPG * 1.2 + nba2k4$DRPG + nba2k4$PPG - nba2k4$TPG)/nba2k4$MPG
nba2k3$team  <- gsub(".*\\(|\\)","", nba2k3$STATS)
nba2k3$STATS  <- gsub("\\\n.*","", nba2k3$STATS)
nba2k3$STATS  <-  removePunctuation(nba2k3$STATS)
nba2k3$custom  <- (nba2k3$APG * 1.1 + nba2k3$ORPG * 1.2 + nba2k3$DRPG + nba2k3$PPG - nba2k3$TPG)/nba2k3$MPG
nba2k2$team  <- gsub(".*\\(|\\)","", nba2k2$STATS)
nba2k2$STATS  <- gsub("\\\n.*","", nba2k2$STATS)
nba2k2$STATS  <-  removePunctuation(nba2k2$STATS)
nba2k2$custom  <- (nba2k2$APG * 1.1 + nba2k2$ORPG * 1.2 + nba2k2$DRPG + nba2k2$PPG - nba2k2$TPG)/nba2k2$MPG
nbaAll  <- merge(nba2k2, nba2k3, by="STATS", all = TRUE)
head(nbaAll)
nbaAll  <- merge(nba2k2, nba2k3, by="STATS", suffixes=c("2012","2013"), all = TRUE)
names(nbaAll)
nbaAll  <- merge(nbaAll, nba2k4, by="STATS", all = TRUE)
names(nbaAll)
head(nbaAll$STATS)
teste  <- subset(nbaAll, drop = c("Player2012","P2012"))
teste  <- nbaAll[, -c(2,3,4,5,6,7,20,21,26,27,28,29,31,44,45,51,54,55,68,69)]
names(teste)
rm(teste)
nba  <- nbaAll[, -c(2,3,4,5,6,7,20,21,26,27,28,29,31,44,45,51,54,55,68,69)]
nba$meanCustom  <- mean(nba$custom2012, nba$custom2013, nba$custom)
names(nba)
nba$meanCustom  <- (nba$custom2012 + nba$custom2013 + nba$custom)/3
summary(nba$meanCustom)
nba$meanFPPM <- (nba$FPPM2012 + nba$FPPM2013 + nba$FPPM)/3
is.null(nba$FAN)
is.NA(nba$FAN)
is.na(nba$FAN)
table(is.na(nba$FAN))
nba$FAN
table(nba$FAN)
nba$FAN  <- as.character(nba$FAN)
table(nba$FAN)
is.na(nba$FAN)
names(nba)
nba[ order(-nba[,53]), c(1,36,52,51,54,55)]
nba[ order(-nba[,53]), c(1,35,36,52,51,54,55)]
nba[ order(-nba[,53]), c(1,35,36,53,52,51,54,55)]
nba[ order(-nba[,53]), c(1,35,36,52,53,51,54,55)]
nba[ order(-nba[,53]), c(1,35,36,52,53,54,51,55)]
round(nba[ order(-nba[,53]), c(1,35,36,52,53,54,51,55)],3)
nbaList <- nba[ order(-nba[,53]), c(1,35,36,52,53,54,51,55)]
nbaList <- subset(nbaList, nbaList$P=="G" | nbaList$P=="GF")
nbaList
nbaList <- nba[ order(-nba[,53]), c(1,35,36,52,53,54,51,55)]
print(nbaList)
nbaList <- subset(nbaList, nbaList$P=="G" | nbaList$P=="GF")
nbaList
nbaList <- subset(nbaList, nbaList$P=="F" | nbaList$P=="GF" | nbaList$P=="FC")
nbaList
nbaList <- subset(nbaList, nbaList$P=="F" | nbaList$P=="GF")
nbaList
nbaList <- nba[ order(-nba[,53]), c(1,35,36,52,53,54,51,55)]
nbaList <- subset(nbaList, nbaList$P=="F" | nbaList$P=="GF")
nbaList
nbaList <- nba[ order(-nba[,53]), c(1,35,36,52,53,54,51,55)]
nbaList
## Three year analysis
nba2k4 <- read.csv("nba_stats_13-14.csv")
nba2k3 <- read.csv("nba_stats_12-13.csv")
nba2k2 <- read.csv("nba_stats_11-12.csv")
nba2k4$team  <- gsub(".*\\(|\\)","", nba2k4$STATS)
nba2k4$STATS  <- gsub("\\\n.*","", nba2k4$STATS)
nba2k4$STATS  <-  removePunctuation(nba2k4$STATS)
nba2k4$custom  <- (nba2k4$APG * 1.1 + nba2k4$ORPG * 1.2 + nba2k4$DRPG + nba2k4$PPG - nba2k4$TPG)/nba2k4$MPG
nba2k3$team  <- gsub(".*\\(|\\)","", nba2k3$STATS)
nba2k3$STATS  <- gsub("\\\n.*","", nba2k3$STATS)
nba2k3$STATS  <-  removePunctuation(nba2k3$STATS)
nba2k3$custom  <- (nba2k3$APG * 1.1 + nba2k3$ORPG * 1.2 + nba2k3$DRPG + nba2k3$PPG - nba2k3$TPG)/nba2k3$MPG
nba2k2$team  <- gsub(".*\\(|\\)","", nba2k2$STATS)
nba2k2$STATS  <- gsub("\\\n.*","", nba2k2$STATS)
nba2k2$STATS  <-  removePunctuation(nba2k2$STATS)
nba2k2$custom  <- (nba2k2$APG * 1.1 + nba2k2$ORPG * 1.2 + nba2k2$DRPG + nba2k2$PPG - nba2k2$TPG)/nba2k2$MPG
# Merge DataFrames
nbaAll  <- merge(nba2k2, nba2k3, by="STATS", suffixes=c("2012","2013"), all = TRUE)
nbaAll  <- merge(nbaAll, nba2k4, by="STATS", all = TRUE)
# Eliminate vars
nba  <- nbaAll[, -c(2,3,4,5,6,7,20,21,26,27,28,29,31,44,45,51,54,55,68,69)]
# Estimate means
nba$meanCustom  <- (nba$custom2012 + nba$custom2013 + nba$custom)/3
nba$meanFPPM <- (nba$FPPM2012 + nba$FPPM2013 + nba$FPPM)/3
# Convert to character
nba$FAN  <- as.character(nba$FAN)
library(tm)
## Three year analysis
nba2k4 <- read.csv("nba_stats_13-14.csv")
nba2k3 <- read.csv("nba_stats_12-13.csv")
nba2k2 <- read.csv("nba_stats_11-12.csv")
nba2k4$team  <- gsub(".*\\(|\\)","", nba2k4$STATS)
nba2k4$STATS  <- gsub("\\\n.*","", nba2k4$STATS)
nba2k4$STATS  <-  removePunctuation(nba2k4$STATS)
nba2k4$custom  <- (nba2k4$APG * 1.1 + nba2k4$ORPG * 1.2 + nba2k4$DRPG + nba2k4$PPG - nba2k4$TPG)/nba2k4$MPG
nba2k3$team  <- gsub(".*\\(|\\)","", nba2k3$STATS)
nba2k3$STATS  <- gsub("\\\n.*","", nba2k3$STATS)
nba2k3$STATS  <-  removePunctuation(nba2k3$STATS)
nba2k3$custom  <- (nba2k3$APG * 1.1 + nba2k3$ORPG * 1.2 + nba2k3$DRPG + nba2k3$PPG - nba2k3$TPG)/nba2k3$MPG
nba2k2$team  <- gsub(".*\\(|\\)","", nba2k2$STATS)
nba2k2$STATS  <- gsub("\\\n.*","", nba2k2$STATS)
nba2k2$STATS  <-  removePunctuation(nba2k2$STATS)
nba2k2$custom  <- (nba2k2$APG * 1.1 + nba2k2$ORPG * 1.2 + nba2k2$DRPG + nba2k2$PPG - nba2k2$TPG)/nba2k2$MPG
# Merge DataFrames
nbaAll  <- merge(nba2k2, nba2k3, by="STATS", suffixes=c("2012","2013"), all = TRUE)
nbaAll  <- merge(nbaAll, nba2k4, by="STATS", all = TRUE)
# Eliminate vars
nba  <- nbaAll[, -c(2,3,4,5,6,7,20,21,26,27,28,29,31,44,45,51,54,55,68,69)]
# Estimate means
nba$meanCustom  <- (nba$custom2012 + nba$custom2013 + nba$custom)/3
nba$meanFPPM <- (nba$FPPM2012 + nba$FPPM2013 + nba$FPPM)/3
# Convert to character
nba$FAN  <- as.character(nba$FAN)
nbaList <- nba[ order(-nba[,53]), c(1,35,36,52,53,54,51,55)]
nbaList
nbaList <- nba[ order(-nba[,51]), c(1,35,36,52,53,54,51,55)]
nbaList <- nba[ order(-nba[,51]), c(1,35,36,52,53,54,51,55)]
nbaList <- subset(nbaList, nbaList$P=="G" | nbaList$P=="GF")
nbaList
tapply(nbaList$FPPM, nbaList$FAN, sum)
tapply(nbaList$FPPM, nbaList$FAN, mean)
tapply(nbaList$FPPM, nbaList$FAN, mean, simplify = TRUE)
prediction <- tapply(nbaList$FPPM, nbaList$FAN, mean, simplify = TRUE)
prediction <- tapply(nbaList$FPPM, nbaList$FAN, mean)
cbind(tapply(nbaList$FPPM, nbaList$FAN, mean))
cbind(round(tapply(nbaList$FPPM, nbaList$FAN, mean)),2)
cbind(tapply(nbaList$FPPM, nbaList$FAN, mean))
library(plyr)
prediction <- tapply(nbaList$FPPM, nbaList$FAN, mean)
df <- ldply(prediction, data.frame)
df
pred <- data.frame(prediction)
pred[order(pred)]
pred[order(pred[,1])]
sort(pred, decreasing = TRUE)
sort(pred$prediction, decreasing = TRUE)
cbind(sort(pred$prediction, decreasing = TRUE))
boxplot(pred$prediction)
prediction <- tapply(nbaList$custom, nbaList$FAN, mean)
pred <- data.frame(prediction)
cbind(sort(pred$prediction, decreasing = TRUE))
boxplot(pred$prediction)
prediction <- tapply(nbaList$FPPM, nbaList$FAN, mean)
pred <- data.frame(prediction)
cbind(sort(pred$prediction, decreasing = TRUE))
prediction <- tapply(nbaList$FPPM, nbaList$FAN, table)
prediction
prediction <- tapply(nba2k4$FPPM, nba2k4$FAN, table)
prediction
pred <- data.frame(prediction)
cbind(sort(pred$prediction, decreasing = TRUE))
prediction <- tapply(nba2k4$FPPM, nba2k4$FAN, mean)
prediction
pred <- data.frame(prediction)
cbind(sort(pred$prediction, decreasing = TRUE))
boxplot(pred$prediction)
cbind(sort(pred$prediction, decreasing = TRUE))
library(caret)
library(rpart)
library(rpart.plot)
library(RWeka)
library(tm)
library(plyr)
setwd("~/nba-predictions/")
nba  <- read.csv("nba_stats_13-14.csv")
teamPer  <- read.csv("teamStats.csv")
nba$team  <- gsub(".*\\(|\\)","", nba$STATS)
nba  <- merge(nba, teamPer, by="team", all.x = TRUE)
nba$STATS  <- gsub("\\\n.*","", nba$STATS)
nba$custom  <- (nba$APG * 1.1 + nba$ORPG * 1.2 + nba$DRPG + nba$PPG - nba$TPG + nba$winning)/nba$MPG
set.seed(999)
nbaPred  <- subset(nba, nba$team!="*FA")
names(nbaPred)
nbaPred  <- subset(nba, nba$team!="*FA")
nbaPred <- nbaPred[,-c(1,2,3,4,6,7,8,10,20,21,22,23,24,25)]
inTraining  <- createDataPartition(nbaPred$custom, p = .75, list = FALSE)
training  <- nbaPred[inTraining, ]; testing  <- nbaPred[-inTraining,]
mpartModel  <- rpart(FPPM ~ . , data = training)
names(nbaPred)
set.seed(999)
nbaPred  <- subset(nba, nba$team!="*FA")
nbaPred <- nbaPred[,-c(1,2,3,4,6,7,8,10,20,21,22,23,24,25)]
inTraining  <- createDataPartition(nbaPred$custom, p = .75, list = FALSE)
training  <- nbaPred[inTraining, ]; testing  <- nbaPred[-inTraining,]
## Train Model - glm
glmModel  <- train(FPPM ~ . ,
data = training, method="glm", preProcess="scale")
summary(glmModel)
glmModel  <- train(custom ~ . ,
data = training, method="glm", preProcess="scale")
summary(glmModel)
mpartModel  <- rpart(custom ~ . , data = training)
mpartPred  <- predict(mpartModel, newdata = testing)
mean(sqrt((testing$custom - mpartPred)^2))
summary(mpartModel)
rpart.plot(mpartModel, type =3, fallen.leaves = TRUE)
library(caret)
library(rpart)
library(rpart.plot)
library(RWeka)
library(tm)
library(plyr)
setwd("~/nba-predictions/")
nba2k4 <- read.csv("nba_stats_13-14.csv")
nba2k4$team  <- gsub(".*\\(|\\)","", nba2k4$STATS)
nba2k4$STATS  <- gsub("\\\n.*","", nba2k4$STATS)
nba2k4$STATS  <-  removePunctuation(nba2k4$STATS)
nba2k4$custom  <- (nba2k4$APG * 1.1 + nba2k4$ORPG * 1.2 + nba2k4$DRPG + nba2k4$PPG - nba2k4$TPG)/nba2k4$MPG
nbaList <- nba[ order(-nba[,51]), c(1,35,36,52,53,54,51,55)]
prediction <- tapply(nba2k4$FPPM, nba2k4$FAN, mean)
prediction
pred <- data.frame(prediction)
cbind(sort(pred$prediction, decreasing = TRUE))
prediction <- tapply(nba2k4$FPPM, nba2k4$FAN, table)
prediction
nbaList <- nba2k4[ order(-nba2k4[,51]), c(1,35,36,52,53,54,51,55)]
boxplot(pred$prediction)
nba2k4 <- read.csv("nba_stats_13-14.csv")
nba2k3 <- read.csv("nba_stats_12-13.csv")
nba2k2 <- read.csv("nba_stats_11-12.csv")
nba2k4$team  <- gsub(".*\\(|\\)","", nba2k4$STATS)
nba2k4$STATS  <- gsub("\\\n.*","", nba2k4$STATS)
nba2k4$STATS  <-  removePunctuation(nba2k4$STATS)
nba2k4$custom  <- (nba2k4$APG * 1.1 + nba2k4$ORPG * 1.2 + nba2k4$DRPG + nba2k4$PPG - nba2k4$TPG)/nba2k4$MPG
nba2k3$team  <- gsub(".*\\(|\\)","", nba2k3$STATS)
nba2k3$STATS  <- gsub("\\\n.*","", nba2k3$STATS)
nba2k3$STATS  <-  removePunctuation(nba2k3$STATS)
nba2k3$custom  <- (nba2k3$APG * 1.1 + nba2k3$ORPG * 1.2 + nba2k3$DRPG + nba2k3$PPG - nba2k3$TPG)/nba2k3$MPG
nba2k2$team  <- gsub(".*\\(|\\)","", nba2k2$STATS)
nba2k2$STATS  <- gsub("\\\n.*","", nba2k2$STATS)
nba2k2$STATS  <-  removePunctuation(nba2k2$STATS)
nba2k2$custom  <- (nba2k2$APG * 1.1 + nba2k2$ORPG * 1.2 + nba2k2$DRPG + nba2k2$PPG - nba2k2$TPG)/nba2k2$MPG
# Merge DataFrames
nbaAll  <- merge(nba2k2, nba2k3, by="STATS", suffixes=c("2012","2013"), all = TRUE)
nbaAll  <- merge(nbaAll, nba2k4, by="STATS", all = TRUE)
# Eliminate vars
nba  <- nbaAll[, -c(2,3,4,5,6,7,20,21,26,27,28,29,31,44,45,51,54,55,68,69)]
# Estimate means
nba$meanCustom  <- (nba$custom2012 + nba$custom2013 + nba$custom)/3
nba$meanFPPM <- (nba$FPPM2012 + nba$FPPM2013 + nba$FPPM)/3
# Convert to character
nba$FAN  <- as.character(nba$FAN)
# Explore
#print
nbaList <- nba[ order(-nba[,51]), c(1,35,36,52,53,54,51,55)]
nbaList
options(digits=2)
nbaList
