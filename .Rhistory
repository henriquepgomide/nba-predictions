install.packages("wordcloud")
install.packages("tm")
install.packages("RColorBrewer")
install.packages("SnowballC")
install.packages("ggplot2")
install.packages("~/Downloads/tm_0.5-9.tar.gz", repos = NULL, type = "source")
source("http://bioconductor.org/biocLite.R")
biocLite("Rgraphviz")
library("tm")
library("SnowballC")
library("Rgraphviz")
library("wordcloud")
library("RColorBrewer")
library("ggplot2")
library(caret)
library(rpart)
library(rpart.plot)
library(RWeka)
library(tm)
library(plyr)
setwd("~/nba-predictions/")
nba2k4 <- read.csv("nba_stats_13-14.csv")
nba2k3 <- read.csv("nba_stats_12-13.csv")
nba2k2 <- read.csv("nba_stats_11-12.csv")
nba2k4$team  <- gsub(".*\\(|\\)","", nba2k4$STATS)
nba2k4$STATS  <- gsub("\\\n.*","", nba2k4$STATS)
nba2k4$STATS  <-  removePunctuation(nba2k4$STATS)
nba2k4$custom  <- (nba2k4$APG * 1.1 + nba2k4$ORPG * 1.2 + nba2k4$DRPG + nba2k4$PPG - nba2k4$TPG)/nba2k4$MPG
nba2k3$team  <- gsub(".*\\(|\\)","", nba2k3$STATS)
nba2k3$STATS  <- gsub("\\\n.*","", nba2k3$STATS)
nba2k3$STATS  <-  removePunctuation(nba2k3$STATS)
nba2k3$custom  <- (nba2k3$APG * 1.1 + nba2k3$ORPG * 1.2 + nba2k3$DRPG + nba2k3$PPG - nba2k3$TPG)/nba2k3$MPG
nba2k2$team  <- gsub(".*\\(|\\)","", nba2k2$STATS)
nba2k2$STATS  <- gsub("\\\n.*","", nba2k2$STATS)
nba2k2$STATS  <-  removePunctuation(nba2k2$STATS)
nba2k2$custom  <- (nba2k2$APG * 1.1 + nba2k2$ORPG * 1.2 + nba2k2$DRPG + nba2k2$PPG - nba2k2$TPG)/nba2k2$MPG
# Merge DataFrames
nbaAll  <- merge(nba2k2, nba2k3, by="STATS", suffixes=c("2012","2013"), all = TRUE)
nbaAll  <- merge(nbaAll, nba2k4, by="STATS", all = TRUE)
# Eliminate vars
nba  <- nbaAll[, -c(2,3,4,5,6,7,20,21,26,27,28,29,31,44,45,51,54,55,68,69)]
# Estimate means
nba$meanCustom  <- (nba$custom2012 + nba$custom2013 + nba$custom)/3
nba$meanFPPM <- (nba$FPPM2012 + nba$FPPM2013 + nba$FPPM)/3
# Convert to character
nba$FAN  <- as.character(nba$FAN)
# Explore
#print
nbaList <- nba[ order(-nba[,51]), c(1,35,36,52,53,54,51,55)]
nbaList
prediction <- tapply(nba2k4$FPPM, nba2k4$FAN, table)
prediction
prediction <- tapply(nba2k4$FPPM, nba2k4$FAN, mean)
prediction
pred <- data.frame(prediction)
barplot(pred$prediction)
c  <- ggplot(pred, aes(prediction))
c + geom_bar()
c  <- ggplot(pred, aes(factor(prediction)))
c + geom_bar()
barplot(pred$prediction, horiz = TRUE)
barplot(sort(pred$prediction), horiz = TRUE)
barplot(sort(pred$prediction), horiz = TRUE, width = 1.5)
barplot(sort(pred$prediction), horiz = TRUE, width = 1.5pc)
?barplot
qplot(pred$prediction)
labels(pred$prediction)
factor(pred$prediction)
c  <- ggplot(pred, aes(prediction))
c + geom(bar)
c + geom_bar()
c + geom_bar(binwidth=27)
c + geom_bar()
